---
layout: post
title:  05/30-flask 模板
date:   2024-09-08 11:24:29 +0800
categories: 
    - python 
    - flask
    - challenge
---

### 使用 Jinja2 模板引擎

Flask 使用 Jinja2 作为模板引擎，允许你在 HTML 文件中嵌入 Python 代码。Jinja2 支持变量替换、条件语句和循环等基本功能。

#### **1. 创建 HTML 模板并传递数据**

Flask 通过 `render_template()` 函数将 Python 数据传递到 HTML 模板中。

**app.py:**
```python
from flask import Flask, render_template

app = Flask(__name__)

@app.route('/')
def index():
    # 数据传递给模板
    return render_template('index.html', name="John", age=30)

if __name__ == '__main__':
    app.run(debug=True)
```

**index.html:**

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome</title>
</head>
<body>
    <h1>Hello, {{ name }}!</h1>
    <p>You are {{ age }} years old.</p>
</body>
</html>
```

在这个示例中，`render_template()` 函数会将 `name` 和 `age` 变量传递给 `index.html`，模板会动态地将这些变量替换成相应的值。

#### **2. 使用 Jinja2 的控制结构**

你还可以在模板中使用控制结构，比如条件语句和循环。

**index.html:**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Info</title>
</head>
<body>
    <h1>Hello, {{ name }}!</h1>
    
    {% if age >= 18 %}
        <p>You are an adult.</p>
    {% else %}
        <p>You are a minor.</p>
    {% endif %}
    
    <h2>Your favorite foods:</h2>
    <ul>
        {% for food in favorite_foods %}
            <li>{{ food }}</li>
        {% endfor %}
    </ul>
</body>
</html>
```

在这个例子中，`if` 和 `for` 控制结构用于显示不同的内容或循环显示列表。

**app.py:**
```python
@app.route('/')
def index():
    favorite_foods = ["Pizza", "Burger", "Ice Cream"]
    return render_template('index.html', name="John", age=30, favorite_foods=favorite_foods)
```

### 模板继承与静态文件

#### **1. 模板继承**

Flask 使用 Jinja2 的模板继承机制，可以定义一个基础布局模板，其他模板继承这个基础模板。

**base.html:**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}My App{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <h1>Welcome to My Website</h1>
    </header>
    
    <main>
        {% block content %}{% endblock %}
    </main>
    
    <footer>
        <p>Footer content here.</p>
    </footer>
</body>
</html>
```

**index.html (继承自 base.html):**
```html
{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
    <h2>Hello, {{ name }}!</h2>
    <p>Welcome to the homepage.</p>
{% endblock %}
```

在 `base.html` 中定义了通用的结构，`index.html` 通过 `extends` 继承它，并用 `block` 标签插入特定内容。这样，你可以在多个页面间共享相同的布局。

#### **2. 加载静态文件**

Flask 提供了 `url_for()` 函数来引用静态文件，比如 CSS、JavaScript 或图像文件。你可以将静态文件存放在 `static` 目录中。

**目录结构：**
```
/static
    /style.css
/templates
    base.html
    index.html
app.py
```

**style.css (存放在 static 目录下):**

```css
body {
    font-family: Arial, sans-serif;
    background-color: #f0f0f0;
}

header {
    background-color: #333;
    color: white;
    padding: 10px;
    text-align: center;
}
```

**app.py:**

```python
from flask import Flask, render_template

app = Flask(__name__)

@app.route('/')
def index():
    return render_template('index.html', name="John")

if __name__ == '__main__':
    app.run(debug=True)
```

在 `base.html` 中，我们通过 `url_for('static', filename='style.css')` 引用了 CSS 文件，Flask 会自动找到 `static` 目录下的文件。

### 总结

- 学习了如何使用 Jinja2 模板引擎，将 Python 数据传递到 HTML 模板，并通过模板中的控制结构来动态生成页面内容。
- 学习了模板继承，通过定义通用布局来简化页面开发，并学习了如何加载静态文件（如 CSS 和 JavaScript）。

这些功能使得 Flask 能够方便地处理动态网页生成和前端布局，适合构建复杂的 `Web` 应用。